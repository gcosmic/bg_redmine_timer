<link rel="import" href="../../bower_components/polymer/polymer.html">

<polymer-element name="stop-watch" attributes="startTS endTS buffer">
  <template>
    <link rel="stylesheet" href="stop-watch.css">
	<button id="play" on-click="{{handleTimer}}" disabled?={{running}}>Play</button>
	<button id="stop" on-click="{{handleTimer}}" disabled?={{!running}}>Stop</button>
	<span id="time">
		{{hours}}:{{minutes}}:{{seconds}}
	</span>
  </template>
  <script>
    (function () {
      Polymer({
		ready: function() {
			this.startTS = 0;
			this.running = false;
			this.hours = "00";
			this.minutes = "00";
			this.seconds = "00";
			this.timer = null;
			this.storedTime = 0;
			this.resuming = false;
		},
		handleTimer : function(){
			var res = 0;
			if (this.running){
				this.resuming =true;
				clearInterval(this.timer);
				//this.hours = this.endTS > 0 ? Math.round(res*100)/100 : 0;
			} else {
				
				if (this.resuming){
					this.startTS = new Date(new Date().getTime()-this.storedTime);
				} else {
					this.startTS = new Date().getTime();
				}
				
				
				
				
				this.timer = setInterval(function() {
					var now = new Date();
					now = now.getTime();
					
					var tempHours = 0;
					var tempMins = 0;
					var tempSecs = 0;
					
					res = now - this.startTS;
					
					
					
					
					tempHours = res/3600000;
					this.hours = pad((Math.floor(tempHours)%60).toString(),2);
					
					tempMins = res/60000;
					this.minutes = pad((Math.floor(tempMins)%60).toString(),2);
					
					tempSecs = res/1000;
					this.seconds = pad((Math.round(tempSecs)%60).toString(),2);
					
					this.storedTime = res;
					
				}.bind(this), 1000); 
			}
			this.running = !this.running;
		}
		
        // define element prototype here
      });
    })();
  </script>
</polymer-element>
